<p-toast></p-toast>

<div class="add-asegurado-form">
  <h3>Añadir Asegurado</h3>
  
  <div class="form-field">
    <label for="tipoSangre">Tipo de Sangre</label>
    <input id="tipoSangre" pInputText [(ngModel)]="nuevoAsegurado.tipoSangre" placeholder="Ingrese el tipo de sangre" />
  </div>

  <div class="form-field">
    <label for="sexo">Sexo</label>
    <input id="sexo" pInputText [(ngModel)]="nuevoAsegurado.sexo" placeholder="Ingrese el sexo" maxlength="1" />
  </div>

  <div class="form-field">
    <label for="fechaNacimiento">Fecha de Nacimiento</label>
    <p-calendar [(ngModel)]="nuevoAsegurado.fechaNacimiento" dateFormat="yy-mm-dd"></p-calendar>
  </div>

  <div class="form-field">
    <label for="usuario">Usuario</label>
    <p-dropdown
      id="usuario"
      [options]="usuariosDisponibles"
      optionLabel="correo"
      optionValue="id"
      [(ngModel)]=nuevoAsegurado.usuario!.id
      placeholder="Seleccione un usuario"
    ></p-dropdown>
  </div>

  <button
    pButton
    label="Añadir Asegurado"
    icon="pi pi-plus"
    (click)="addAsegurado()"
    class="p-button-success"
  ></button>
</div>

<div class="asegurado-list-container" style="margin-top: 2rem;">
  <p-table [value]="asegurados" dataKey="id" [tableStyle]="{ 'min-width': '50rem', 'max-width': '100%' }">
    <ng-template pTemplate="header">
      <tr>
        <th style="width: 20%">ID</th>
        <th style="width: 20%">Tipo de Sangre</th>
        <th style="width: 10%">Sexo</th>
        <th style="width: 20%">Fecha de Nacimiento</th>
        <th style="width: 20%">Nombre Completo</th>
        <th style="width: 10%">Acción</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-asegurado>
      <tr>
        <td>{{ asegurado.id }}</td>
        <td>{{ asegurado.tipoSangre }}</td>
        <td>{{ asegurado.sexo }}</td>
        <td>{{ asegurado.fechaNacimiento }}</td>
        <td>{{ asegurado.usuario?.nombre }} {{ asegurado.usuario?.apellido }}</td>
        <td>
          <button
            pButton
            icon="pi pi-trash"
            class="p-button-rounded p-button-danger"
            (click)="deleteAsegurado(asegurado.id)"
            style="width: 2rem; height: 2rem;"
          ></button>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>
